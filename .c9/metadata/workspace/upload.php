{"changed":true,"filter":false,"title":"upload.php","tooltip":"/upload.php","value":"<?php\n// bms2json\n// TODO : 小節、BPM、STOP、LN\nheader(\"Content-type: text/html; charset=utf-8\");\nmb_internal_encoding(\"utf-8\");\ndate_default_timezone_set('Asia/Tokyo');\n\nfunction get_table($md5, $url){\n\t    $json = file_get_contents($url);\n\t\t$table = json_decode($json);\n\t\tfor($i = 0; $i < count($table); $i++){\n\t\t\tif($table[$i]->md5 === $md5)\n\t\t\t\treturn $table[$i]->level;\n\t\t}\n\t\treturn FALSE;\n}\n\nif(is_uploaded_file($_FILES[\"file\"][\"tmp_name\"])){\n\t$get_file = $_FILES[\"file\"][\"tmp_name\"];\n\t\n\t// load bms file\n\t$bms_data = file_get_contents($get_file);\n\t$file_hash = md5($bms_data);\n\n\t// err_check\n\n\n\t// convert utf8\n\t$bms_data = mb_convert_encoding($bms_data, \"UTF-8\", \"ASCII, SJIS, sjis-win, EUC-JP\");\n\n\t$bms_string_array = explode(\"\\n\", $bms_data);\n\t$file_name = \"./json/\".$file_hash.\".json\";\n\n\tif($insane_dif = get_table($file_hash, \"http://bmsnormal2.syuriken.jp/insane/data.json\"))\n\t\t$difficulty[] = \"★\".$insane_dif;\n\n\t$total_notes = 0;\n\t$max_measure = 0;\n\t\n\t$ln_end = false;\n\t//parse bms2json\n\tfor($i = 0; $i < count($bms_string_array); $i++){\n\t\tif(substr($bms_string_array[$i], 0, 1) != \"#\")\n\t\t\tcontinue;\n\t\telse{\n\t\t\t$temp_str = substr($bms_string_array[$i], 1);\n\t\t\t$channel = explode(\":\", $temp_str, 2);\n\n\t\t\tif(is_numeric($channel[0])){\n\t\t\t\t$now_measure = (int)substr($channel[0], 0, 3);\n\t\t\t\t$max_measure = (int)max($now_measure, $max_measure);\n\n\t\t\t\t// -1 is delete return char\n\t\t\t\t$resolution = (strlen($channel[1]) - 1) / 2;\n\t\t\t\t\n\t\t\t\tif((int)substr($channel[0], 3, 2) == 2){\n\t\t\t\t\t$measure_length[$now_measure] = (float)$channel[1];\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tfor($step = 0; $step < $resolution; $step++){\n\t\t\t\t\tif(!(substr($channel[1], $step * 2, 2) === \"00\")){\n\t\t\t\t\t\t// if this command is visible note\n\t\t\t\t\t\tif(substr($channel[0], 3, 2) >= 11 && substr($channel[0], 3, 2) <= 19)\n\t\t\t\t\t\t\t$total_notes++;\n\t\t\t\t\t\t\n\t\t\t\t\t\t$note_pos = (($resolution - $step) / $resolution);\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(substr($channel[0], 3, 2)  >= 11 && substr($channel[0], 3, 2) <= 59){\n\t\t\t\t\t\t\tif($ln_end){\n\t\t\t\t\t\t\t\t$total_notes++;\n\t\t\t\t\t\t\t\t$ln_end = !$ln_end;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\t$ln_end = !$ln_end;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tswitch (substr($channel[0], 3, 2)){\n\t\t\t\t\t\tcase 16:\n\t\t\t\t\t\t\t$key[0][(int)$now_measure][] = $note_pos;\n\t\t\t\t\t\t\tcontinue 2;\n\t\t\t\t\t\tcase 11:\n\t\t\t\t\t\t\t$key[1][(int)$now_measure][] = $note_pos;\n\t\t\t\t\t\t\tcontinue 2;\n\t\t\t\t\t\tcase 12:\n\t\t\t\t\t\t\t$key[2][(int)$now_measure][] = $note_pos;\n\t\t\t\t\t\t\tcontinue 2;\n\t\t\t\t\t\tcase 13:\n\t\t\t\t\t\t\t$key[3][(int)$now_measure][] = $note_pos;\n\t\t\t\t\t\t\tcontinue 2;\n\t\t\t\t\t\tcase 14:\n\t\t\t\t\t\t\t$key[4][(int)$now_measure][] = $note_pos;\n\t\t\t\t\t\t\tcontinue 2;\n\t\t\t\t\t\tcase 15:\n\t\t\t\t\t\t\t$key[5][(int)$now_measure][] = $note_pos;\n\t\t\t\t\t\t\tcontinue 2;\n\t\t\t\t\t\tcase 18:\n\t\t\t\t\t\t\t$key[6][(int)$now_measure][] = $note_pos;\n\t\t\t\t\t\t\tcontinue 2;\n\t\t\t\t\t\tcase 19:\n\t\t\t\t\t\t\t$key[7][(int)$now_measure][] = $note_pos;\n\t\t\t\t\t\t\tcontinue 2;\n\t\t\t\t\t\tcase 56:\n\t\t\t\t\t\t\t$lnkey[0] = (int)$now_measure + $note_pos;\n\t\t\t\t\t\t\tcontinue 2;\n\t\t\t\t\t\tcase 51:\n\t\t\t\t\t\t\t$lnkey[1] = (int)$now_measure + $note_pos;\n\t\t\t\t\t\t\tcontinue 2;\n\t\t\t\t\t\tcase 52:\n\t\t\t\t\t\t\t$lnkey[2] = (int)$now_measure + $note_pos;\n\t\t\t\t\t\t\tcontinue 2;\n\t\t\t\t\t\tcase 53:\n\t\t\t\t\t\t\t$lnkey[3] = (int)$now_measure + $note_pos;\n\t\t\t\t\t\t\tcontinue 2;\n\t\t\t\t\t\tcase 54:\n\t\t\t\t\t\t\t$lnkey[4] = (int)$now_measure + $note_pos;\n\t\t\t\t\t\t\tcontinue 2;\n\t\t\t\t\t\tcase 55:\n\t\t\t\t\t\t\t$lnkey[5] = (int)$now_measure + $note_pos;\n\t\t\t\t\t\t\tcontinue 2;\n\t\t\t\t\t\tcase 58:\n\t\t\t\t\t\t\t$lnkey[6] = (int)$now_measure + $note_pos;\n\t\t\t\t\t\t\tcontinue 2;\n\t\t\t\t\t\tcase 59:\n\t\t\t\t\t\t\t$lnkey[7] = (int)$now_measure + $note_pos;\n\t\t\t\t\t\t\tcontinue 2;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\n\t\t\t}\n\t\t\t// HEADER 処理\n\t\t\telse{\n\t\t\t\t$header = explode(\" \", $temp_str, 2);\n\t\t\t\t$header_map[$header[0]] = htmlspecialchars(substr($header[1], 0, -1), ENT_QUOTES, \"UTF-8\");\n\t\t\t}\n\t\t}\n\t}\n\n\tif($header_map[\"TITLE\"] == null){\n\t\techo '<div class=\"alert alert-danger\">';\n\t\techo \"このBMSファイルには#TITLEが存在しなかったため、アップロードは行われませんでした。 \".date(\"H:i:s\");\n\t\techo \"</div>\";\n\t\texit();\n\t}\n\tif($total_notes <= 0){\n\t\techo '<div class=\"alert alert-danger\">';\n\t\techo \"このBMSファイルには可視ノーツが1つも存在しなかったため、アップロードは行われませんでした。 \".date(\"H:i:s\");\n\t\techo \"</div>\";\n\t\texit();\n\t}\n\tif($header_map[\"RANDOM\"] != null){\n\t\techo '<div class=\"alert alert-danger\">';\n\t\techo \"このBMSファイルには#RANDOMが存在したため、アップロードは行われませんでした。 \".date(\"H:i:s\");\n\t\techo \"</div>\";\n\t\texit();\n\t}\n\t\n\tfor($key_num = 0; $key_num <= 7; $key_num++){\n\t\tsort($lnkey[$key_num]);\n\t}\n\t\n\t//out json\n\t$output_json = array(\n\t\t\"GENRE\" => $header_map[\"GENRE\"],\n\t\t\"TITLE\" => $header_map[\"TITLE\"],\n\t\t\"ARTIST\" => $header_map[\"ARTIST\"],\n\t\t\"BPM\" => $header_map[\"BPM\"],\n\t\t\"RANK\" => $header_map[\"RANK\"],\n\t\t\"TOTAL\" => $header_map[\"TOTAL\"],\n\n\t\t\"notes\" => $total_notes,\n\t\t\"measure\" => $max_measure,\n\t\t\"measure_length\" => $measure_length,\n\n\t\t\"lgkey\" => $key,\n\t\t\"lnkey\" => $lnkey,\n\t\t/*\n\t\t\"landmine\" => ,\n\t\t*/\n\n\t\t\"difficulty\" => $difficulty,\n\t);\n\n\t$file_upload_success = file_put_contents($file_name, json_encode($output_json));\n\tif(!($file_upload_success === FALSE)){\n\t\techo '<div class=\"alert alert-success\">';\n\t\techo \"アップロードに成功しました。 : \".$header_map[\"TITLE\"].\", \".date(\"H:i:s\").\"<br />\";\n\t\techo \"<a href=\\\"\".\"./score.php?md5=\".$file_hash.\"\\\">\".\"Score\".\"</a>\";\n\t\techo '</div>';\n\t}\n\telse{\n\t\techo '<div class=\"alert alert-danger\">';\n\t\techo \"譜面のアップロードに失敗しました。<br />しばらく時間をおいてからもう一度試してみてください。 \".date(\"H:i:s\");\n\t\techo '</div>';\n\t}\n}\n\nelse{\n\t\techo '<div class=\"alert alert-danger\">';\n\t\techo \"ファイルが選択されていません\";\n\t\techo \"</div>\";\n}\n\n?>\n","undoManager":{"mark":97,"position":100,"stack":[[{"group":"doc","deltas":[{"start":{"row":20,"column":3},"end":{"row":20,"column":4},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":20,"column":4},"end":{"row":20,"column":5},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":20,"column":5},"end":{"row":20,"column":6},"action":"insert","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":20,"column":6},"end":{"row":20,"column":7},"action":"insert","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":20,"column":7},"end":{"row":20,"column":8},"action":"insert","lines":["c"]}]}],[{"group":"doc","deltas":[{"start":{"row":20,"column":8},"end":{"row":20,"column":9},"action":"insert","lines":["h"]}]}],[{"group":"doc","deltas":[{"start":{"row":20,"column":9},"end":{"row":20,"column":10},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":20,"column":10},"end":{"row":20,"column":11},"action":"insert","lines":["c"]}]}],[{"group":"doc","deltas":[{"start":{"row":20,"column":11},"end":{"row":20,"column":12},"action":"insert","lines":["k"]}]}],[{"group":"doc","deltas":[{"start":{"row":20,"column":7},"end":{"row":20,"column":8},"action":"insert","lines":["_"]}]}],[{"group":"doc","deltas":[{"start":{"row":21,"column":0},"end":{"row":23,"column":1},"action":"insert","lines":["if ($_FILES['file1']['size'] > PERMIT_SIZE) {","    die(\"ファイルがデカいよ\");","}"]}]}],[{"group":"doc","deltas":[{"start":{"row":21,"column":17},"end":{"row":21,"column":18},"action":"remove","lines":["1"]}]}],[{"group":"doc","deltas":[{"start":{"row":21,"column":0},"end":{"row":21,"column":1},"action":"insert","lines":["\t"]}]}],[{"group":"doc","deltas":[{"start":{"row":22,"column":4},"end":{"row":22,"column":5},"action":"insert","lines":["\t"]}]}],[{"group":"doc","deltas":[{"start":{"row":23,"column":0},"end":{"row":23,"column":1},"action":"insert","lines":["\t"]}]}],[{"group":"doc","deltas":[{"start":{"row":22,"column":7},"end":{"row":22,"column":8},"action":"remove","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":22,"column":6},"end":{"row":22,"column":7},"action":"remove","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":22,"column":5},"end":{"row":22,"column":6},"action":"remove","lines":["d"]}]}],[{"group":"doc","deltas":[{"start":{"row":22,"column":5},"end":{"row":22,"column":6},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":22,"column":6},"end":{"row":22,"column":7},"action":"insert","lines":["x"]}]}],[{"group":"doc","deltas":[{"start":{"row":22,"column":7},"end":{"row":22,"column":8},"action":"insert","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":22,"column":8},"end":{"row":22,"column":9},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":22,"column":10},"end":{"row":22,"column":11},"action":"remove","lines":["\""]}]}],[{"group":"doc","deltas":[{"start":{"row":22,"column":10},"end":{"row":22,"column":11},"action":"remove","lines":["フ"]}]}],[{"group":"doc","deltas":[{"start":{"row":22,"column":10},"end":{"row":22,"column":11},"action":"remove","lines":["ァ"]}]}],[{"group":"doc","deltas":[{"start":{"row":22,"column":10},"end":{"row":22,"column":11},"action":"remove","lines":["イ"]}]}],[{"group":"doc","deltas":[{"start":{"row":22,"column":10},"end":{"row":22,"column":11},"action":"remove","lines":["ル"]}]}],[{"group":"doc","deltas":[{"start":{"row":22,"column":10},"end":{"row":22,"column":11},"action":"remove","lines":["が"]}]}],[{"group":"doc","deltas":[{"start":{"row":22,"column":10},"end":{"row":22,"column":11},"action":"remove","lines":["デ"]}]}],[{"group":"doc","deltas":[{"start":{"row":22,"column":10},"end":{"row":22,"column":11},"action":"remove","lines":["カ"]}]}],[{"group":"doc","deltas":[{"start":{"row":22,"column":10},"end":{"row":22,"column":11},"action":"remove","lines":["い"]}]}],[{"group":"doc","deltas":[{"start":{"row":22,"column":10},"end":{"row":22,"column":11},"action":"remove","lines":["よ"]}]}],[{"group":"doc","deltas":[{"start":{"row":22,"column":10},"end":{"row":22,"column":11},"action":"remove","lines":["\""]}]}],[{"group":"doc","deltas":[{"start":{"row":20,"column":13},"end":{"row":23,"column":2},"action":"remove","lines":["","\tif ($_FILES['file']['size'] > PERMIT_SIZE) {","    \texit();","\t}"]}]}],[{"group":"doc","deltas":[{"start":{"row":20,"column":13},"end":{"row":21,"column":0},"action":"insert","lines":["",""]},{"start":{"row":21,"column":0},"end":{"row":21,"column":1},"action":"insert","lines":["\t"]}]}],[{"group":"doc","deltas":[{"start":{"row":21,"column":1},"end":{"row":21,"column":2},"action":"insert","lines":["$"]}]}],[{"group":"doc","deltas":[{"start":{"row":21,"column":1},"end":{"row":21,"column":2},"action":"remove","lines":["$"]}]}],[{"group":"doc","deltas":[{"start":{"row":21,"column":0},"end":{"row":21,"column":1},"action":"remove","lines":["\t"]}]}],[{"group":"doc","deltas":[{"start":{"row":20,"column":13},"end":{"row":21,"column":0},"action":"remove","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":20,"column":13},"end":{"row":21,"column":0},"action":"insert","lines":["",""]},{"start":{"row":21,"column":0},"end":{"row":21,"column":1},"action":"insert","lines":["\t"]}]}],[{"group":"doc","deltas":[{"start":{"row":21,"column":1},"end":{"row":21,"column":2},"action":"insert","lines":["$"]}]}],[{"group":"doc","deltas":[{"start":{"row":21,"column":1},"end":{"row":21,"column":2},"action":"remove","lines":["$"]}]}],[{"group":"doc","deltas":[{"start":{"row":21,"column":1},"end":{"row":21,"column":2},"action":"insert","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":21,"column":2},"end":{"row":21,"column":3},"action":"insert","lines":["f"]}]}],[{"group":"doc","deltas":[{"start":{"row":21,"column":3},"end":{"row":21,"column":5},"action":"insert","lines":["()"]}]}],[{"group":"doc","deltas":[{"start":{"row":21,"column":4},"end":{"row":21,"column":5},"action":"insert","lines":["$"]}]}],[{"group":"doc","deltas":[{"start":{"row":21,"column":5},"end":{"row":21,"column":6},"action":"insert","lines":["g"]}]}],[{"group":"doc","deltas":[{"start":{"row":21,"column":6},"end":{"row":21,"column":7},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":21,"column":7},"end":{"row":21,"column":8},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":21,"column":8},"end":{"row":21,"column":9},"action":"insert","lines":["_"]}]}],[{"group":"doc","deltas":[{"start":{"row":22,"column":0},"end":{"row":23,"column":0},"action":"insert","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":22,"column":0},"end":{"row":23,"column":0},"action":"remove","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":21,"column":4},"end":{"row":21,"column":5},"action":"insert","lines":["!"]}]}],[{"group":"doc","deltas":[{"start":{"row":21,"column":5},"end":{"row":21,"column":6},"action":"insert","lines":["u"]}]}],[{"group":"doc","deltas":[{"start":{"row":21,"column":6},"end":{"row":21,"column":7},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":21,"column":6},"end":{"row":21,"column":7},"action":"remove","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":21,"column":5},"end":{"row":21,"column":6},"action":"remove","lines":["u"]}]}],[{"group":"doc","deltas":[{"start":{"row":21,"column":5},"end":{"row":21,"column":6},"action":"insert","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":21,"column":6},"end":{"row":21,"column":7},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":21,"column":7},"end":{"row":21,"column":8},"action":"insert","lines":["_"]}]}],[{"group":"doc","deltas":[{"start":{"row":21,"column":8},"end":{"row":21,"column":9},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":21,"column":9},"end":{"row":21,"column":10},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":21,"column":10},"end":{"row":21,"column":11},"action":"insert","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":21,"column":5},"end":{"row":21,"column":11},"action":"remove","lines":["is_str"]},{"start":{"row":21,"column":5},"end":{"row":21,"column":16},"action":"insert","lines":["is_string()"]}]}],[{"group":"doc","deltas":[{"start":{"row":21,"column":15},"end":{"row":21,"column":16},"action":"remove","lines":[")"]}]}],[{"group":"doc","deltas":[{"start":{"row":21,"column":20},"end":{"row":21,"column":21},"action":"insert","lines":["f"]}]}],[{"group":"doc","deltas":[{"start":{"row":21,"column":21},"end":{"row":21,"column":22},"action":"insert","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":21,"column":22},"end":{"row":21,"column":23},"action":"insert","lines":["l"]}]}],[{"group":"doc","deltas":[{"start":{"row":21,"column":23},"end":{"row":21,"column":24},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":21,"column":25},"end":{"row":21,"column":26},"action":"insert","lines":[")"]}]}],[{"group":"doc","deltas":[{"start":{"row":21,"column":26},"end":{"row":21,"column":27},"action":"insert","lines":[";"]}]}],[{"group":"doc","deltas":[{"start":{"row":21,"column":26},"end":{"row":21,"column":27},"action":"remove","lines":[";"]}]}],[{"group":"doc","deltas":[{"start":{"row":21,"column":26},"end":{"row":21,"column":27},"action":"insert","lines":["{"]}]}],[{"group":"doc","deltas":[{"start":{"row":21,"column":27},"end":{"row":23,"column":2},"action":"insert","lines":["","\t\t","\t}"]}]}],[{"group":"doc","deltas":[{"start":{"row":22,"column":2},"end":{"row":22,"column":3},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":22,"column":2},"end":{"row":22,"column":3},"action":"remove","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":22,"column":2},"end":{"row":24,"column":1},"action":"insert","lines":["if ($_FILES['file1']['size'] > PERMIT_SIZE) {","    die(\"ファイルがデカいよ\");","}"]}]}],[{"group":"doc","deltas":[{"start":{"row":21,"column":27},"end":{"row":24,"column":1},"action":"remove","lines":["","\t\tif ($_FILES['file1']['size'] > PERMIT_SIZE) {","    die(\"ファイルがデカいよ\");","}"]}]}],[{"group":"doc","deltas":[{"start":{"row":21,"column":27},"end":{"row":25,"column":9},"action":"insert","lines":["","\t\techo '<div class=\"alert alert-danger\">';","\t\techo \"このBMSファイルには#TITLEが存在しなかったため、アップロードは行われませんでした。 \".date(\"H:i:s\");","\t\techo \"</div>\";","\t\texit();"]}]}],[{"group":"doc","deltas":[{"start":{"row":23,"column":8},"end":{"row":23,"column":54},"action":"remove","lines":["このBMSファイルには#TITLEが存在しなかったため、アップロードは行われませんでした。 "]}]}],[{"group":"doc","deltas":[{"start":{"row":23,"column":8},"end":{"row":23,"column":9},"action":"insert","lines":["m"]}]}],[{"group":"doc","deltas":[{"start":{"row":23,"column":8},"end":{"row":23,"column":9},"action":"remove","lines":["m"]}]}],[{"group":"doc","deltas":[{"start":{"row":23,"column":8},"end":{"row":23,"column":11},"action":"insert","lines":["文字列"]}]}],[{"group":"doc","deltas":[{"start":{"row":23,"column":11},"end":{"row":23,"column":13},"action":"insert","lines":["では"]}]}],[{"group":"doc","deltas":[{"start":{"row":23,"column":13},"end":{"row":23,"column":17},"action":"insert","lines":["ありませ"]}]}],[{"group":"doc","deltas":[{"start":{"row":23,"column":17},"end":{"row":23,"column":18},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":23,"column":17},"end":{"row":23,"column":18},"action":"insert","lines":["ん"]}]}],[{"group":"doc","deltas":[{"start":{"row":29,"column":0},"end":{"row":32,"column":29},"action":"remove","lines":["","\t// load bms file","\t$bms_data = file_get_contents($get_file);","\t$file_hash = md5($bms_data);"]}]}],[{"group":"doc","deltas":[{"start":{"row":18,"column":41},"end":{"row":19,"column":0},"action":"insert","lines":["",""]},{"start":{"row":19,"column":0},"end":{"row":19,"column":1},"action":"insert","lines":["\t"]}]}],[{"group":"doc","deltas":[{"start":{"row":19,"column":1},"end":{"row":22,"column":29},"action":"insert","lines":["","\t// load bms file","\t$bms_data = file_get_contents($get_file);","\t$file_hash = md5($bms_data);"]}]}],[{"group":"doc","deltas":[{"start":{"row":25,"column":16},"end":{"row":25,"column":24},"action":"remove","lines":["get_file"]}]}],[{"group":"doc","deltas":[{"start":{"row":25,"column":16},"end":{"row":25,"column":17},"action":"insert","lines":["b"]}]}],[{"group":"doc","deltas":[{"start":{"row":25,"column":17},"end":{"row":25,"column":18},"action":"insert","lines":["m"]}]}],[{"group":"doc","deltas":[{"start":{"row":25,"column":18},"end":{"row":25,"column":19},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":25,"column":19},"end":{"row":25,"column":20},"action":"insert","lines":["_"]}]}],[{"group":"doc","deltas":[{"start":{"row":25,"column":20},"end":{"row":25,"column":21},"action":"insert","lines":["d"]}]}],[{"group":"doc","deltas":[{"start":{"row":25,"column":21},"end":{"row":25,"column":22},"action":"insert","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":25,"column":15},"end":{"row":25,"column":22},"action":"remove","lines":["$bms_da"]},{"start":{"row":25,"column":15},"end":{"row":25,"column":24},"action":"insert","lines":["$bms_data"]}]}],[{"group":"doc","deltas":[{"start":{"row":24,"column":13},"end":{"row":30,"column":2},"action":"remove","lines":["","\tif(!is_string($bms_data)){","\t\techo '<div class=\"alert alert-danger\">';","\t\techo \"文字列ではありません \".date(\"H:i:s\");","\t\techo \"</div>\";","\t\texit();","\t}"]}]}],[{"group":"doc","deltas":[{"start":{"row":26,"column":0},"end":{"row":27,"column":0},"action":"remove","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":25,"column":0},"end":{"row":26,"column":0},"action":"remove","lines":["",""]}]}]]},"ace":{"folds":[],"scrolltop":2400,"scrollleft":0,"selection":{"start":{"row":135,"column":33},"end":{"row":135,"column":33},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":28,"mode":"ace/mode/php"}},"timestamp":1428228144071}