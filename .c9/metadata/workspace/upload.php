{"changed":true,"filter":false,"title":"upload.php","tooltip":"/upload.php","value":"<?php\n// bms2json\n// TODO : 小節、BPM、STOP、LN\ninclude_once('mysql.php');\n\n$db = new ConnectMysql();\n\nmb_internal_encoding(\"utf-8\");\ndate_default_timezone_set('Asia/Tokyo');\n\nif(is_uploaded_file($_FILES[\"file\"][\"tmp_name\"])){\n\t$get_file = $_FILES[\"file\"][\"tmp_name\"];\n\t\n\t// load bms file\n\t$bms_data = file_get_contents($get_file);\n\t$file_hash = md5($bms_data);\n\n\t// err_check\n\tif(!is_string($bms_data)){\n\t\techo '<div class=\"alert alert-danger\">';\n\t\techo \"ファイルがBMSじゃないような気がします。 \".date(\"H:i:s\");\n\t\techo \"</div>\";\n\t\texit();\n\t}\n\n\t// convert utf8\n\t$bms_data = mb_convert_encoding($bms_data, \"UTF-8\", \"ASCII, SJIS, sjis-win, EUC-JP\");\n\n\t$bms_string_array = explode(\"\\n\", $bms_data);\n\t$file_name = \"./json/\".$file_hash.\".json\";\n\n\t$total_notes = 0;\n\t$max_measure = 0;\n\t\n\t// chk LNOBJ\n\tfor($i = 0; $i < count($bms_string_array); $i++){\n\t\tif(substr($bms_string_array[$i], 0, 6) == \"#LNOBJ\"){\n\t\t\t$lnobj_array[substr($bms_string_array[$i], 7, 2)] = true;\n\t\t}\n\t}\n\t\n\t//parse bms2json\n\tfor($i = 0; $i < count($bms_string_array); $i++){\n\t\t// chk command\n\t\tif(substr($bms_string_array[$i], 0, 1) != \"#\")\n\t\t\tcontinue;\n\t\t\t\n\t\telse{\n\t\t\t$temp_str = substr($bms_string_array[$i], 1);\n\t\t\t$channel = explode(\":\", $temp_str, 2);\n\n\t\t\tif(is_numeric($channel[0])){\n\t\t\t\t$before_measure = $now_measure;\n\t\t\t\t$now_measure = (int)substr($channel[0], 0, 3);\n\t\t\t\t$max_measure = (int)max($now_measure, $max_measure);\n\t\t\t\t\n\t\t\t\t// -1 is delete return char\n\t\t\t\t$resolution = (strlen($channel[1]) - 1) / 2;\n\t\t\t\t\n\t\t\t\tif((int)substr($channel[0], 3, 2) == 2){\n\t\t\t\t\t$measure_length[$now_measure] = (float)$channel[1];\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tfor($step = 0; $step < $resolution; $step++){\n\t\t\t\t\tif(!(substr($channel[1], $step * 2, 2) === \"00\")){\n\t\t\t\t\t\t\n\t\t\t\t\t\t// if this command is visible note\n\t\t\t\t\t\tif(substr($channel[0], 3, 2) >= 11 && substr($channel[0], 3, 2) <= 59){\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t$before_note_pos = $note_pos;\n\t\t\t\t\t\t\t$note_pos = (($resolution - $step) / $resolution);\n\t\t\t\t\t\t\t// if this id is not lnobj\n\t\t\t\t\t\t\tif($lnobj_array[substr($channel[1], $step * 2, 2)] != true){\n\t\t\t\t\t\t\t\t$total_notes++;\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tswitch (substr($channel[0], 3, 2)){\n\t\t\t\t\t\t\t\tcase 16:\n\t\t\t\t\t\t\t\t\t$key[0][(int)$now_measure][] = $note_pos;\n\t\t\t\t\t\t\t\t\tcontinue 2;\n\t\t\t\t\t\t\t\tcase 11:\n\t\t\t\t\t\t\t\t\t$key[1][(int)$now_measure][] = $note_pos;\n\t\t\t\t\t\t\t\t\tcontinue 2;\n\t\t\t\t\t\t\t\tcase 12:\n\t\t\t\t\t\t\t\t\t$key[2][(int)$now_measure][] = $note_pos;\n\t\t\t\t\t\t\t\t\tcontinue 2;\n\t\t\t\t\t\t\t\tcase 13:\n\t\t\t\t\t\t\t\t\t$key[3][(int)$now_measure][] = $note_pos;\n\t\t\t\t\t\t\t\t\tcontinue 2;\n\t\t\t\t\t\t\t\tcase 14:\n\t\t\t\t\t\t\t\t\t$key[4][(int)$now_measure][] = $note_pos;\n\t\t\t\t\t\t\t\t\tcontinue 2;\n\t\t\t\t\t\t\t\tcase 15:\n\t\t\t\t\t\t\t\t\t$key[5][(int)$now_measure][] = $note_pos;\n\t\t\t\t\t\t\t\t\tcontinue 2;\n\t\t\t\t\t\t\t\tcase 18:\n\t\t\t\t\t\t\t\t\t$key[6][(int)$now_measure][] = $note_pos;\n\t\t\t\t\t\t\t\t\tcontinue 2;\n\t\t\t\t\t\t\t\tcase 19:\n\t\t\t\t\t\t\t\t\t$key[7][(int)$now_measure][] = $note_pos;\n\t\t\t\t\t\t\t\t\tcontinue 2;\n\t\t\t\t\t\t\t\tcase 56:\n\t\t\t\t\t\t\t\t\t$lnkey[0][] = (int)$now_measure + $note_pos;\n\t\t\t\t\t\t\t\t\tcontinue 2;\n\t\t\t\t\t\t\t\tcase 51:\n\t\t\t\t\t\t\t\t\t$lnkey[1][]= (int)$now_measure + $note_pos;\n\t\t\t\t\t\t\t\t\tcontinue 2;\n\t\t\t\t\t\t\t\tcase 52:\n\t\t\t\t\t\t\t\t\t$lnkey[2][] = (int)$now_measure + $note_pos;\n\t\t\t\t\t\t\t\t\tcontinue 2;\n\t\t\t\t\t\t\t\tcase 53:\n\t\t\t\t\t\t\t\t\t$lnkey[3][] = (int)$now_measure + $note_pos;\n\t\t\t\t\t\t\t\t\tcontinue 2;\n\t\t\t\t\t\t\t\tcase 54:\n\t\t\t\t\t\t\t\t\t$lnkey[4][] = (int)$now_measure + $note_pos;\n\t\t\t\t\n\t\t\t\t\t\t\t\t\tcontinue 2;\n\t\t\t\t\t\t\t\tcase 55:\n\t\t\t\t\t\t\t\t\t$lnkey[5][] = (int)$now_measure + $note_pos;\n\t\t\t\t\t\t\t\t\tcontinue 2;\n\t\t\t\t\t\t\t\tcase 58:\n\t\t\t\t\t\t\t\t\t$lnkey[6][] = (int)$now_measure + $note_pos;\n\t\t\t\t\t\t\t\t\tcontinue 2;\n\t\t\t\t\t\t\t\tcase 59:\n\t\t\t\t\t\t\t\t\t$lnkey[7][] = (int)$now_measure + $note_pos;\n\t\t\t\t\t\t\t\t\tcontinue 2;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t// LNOBJ\n\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\tswitch (substr($channel[0], 3, 2)){\n\t\t\t\t\t\t\t\tcase 16:\n\t\t\t\t\t\t\t\t\t$lnkey[0][] = $before_note_pos + $before_measure;\n\t\t\t\t\t\t\t\t\t$lnkey[0][] = (int)$now_measure + $note_pos;\n\t\t\t\t\t\t\t\tcontinue 2;\n\t\t\t\t\t\t\t\tcase 11:\n\t\t\t\t\t\t\t\t\t$lnkey[1][] = $before_note_pos + $before_measure;\n\t\t\t\t\t\t\t\t\t$lnkey[1][] = (int)$now_measure + $note_pos;\n\t\t\t\t\t\t\t\t\tcontinue 2;\n\t\t\t\t\t\t\t\tcase 12:\n\t\t\t\t\t\t\t\t\t$lnkey[2][] = $before_note_pos + $before_measure;\n\t\t\t\t\t\t\t\t\t$lnkey[2][] = (int)$now_measure + $note_pos;\n\t\t\t\t\t\t\t\t\tcontinue 2;\n\t\t\t\t\t\t\t\tcase 13:\n\t\t\t\t\t\t\t\t\t$lnkey[3][] = $before_note_pos + $before_measure;\n\t\t\t\t\t\t\t\t\t$lnkey[3][] = (int)$now_measure + $note_pos;\n\t\t\t\t\t\t\t\t\tcontinue 2;\n\t\t\t\t\t\t\t\tcase 14:\n\t\t\t\t\t\t\t\t\t$lnkey[4][] = $before_note_pos + $before_measure;\n\t\t\t\t\t\t\t\t\t$lnkey[4][] = (int)$now_measure + $note_pos;\n\t\t\t\t\t\t\t\t\tcontinue 2;\n\t\t\t\t\t\t\t\tcase 15:\n\t\t\t\t\t\t\t\t\t$lnkey[5][] = $before_note_pos + $before_measure;\n\t\t\t\t\t\t\t\t\t$lnkey[5][] = (int)$now_measure + $note_pos;\n\t\t\t\t\t\t\t\t\tcontinue 2;\n\t\t\t\t\t\t\t\tcase 18:\n\t\t\t\t\t\t\t\t\t$lnkey[6][] = $before_note_pos + $before_measure;\n\t\t\t\t\t\t\t\t\t$lnkey[6][] = (int)$now_measure + $note_pos;\n\t\t\t\t\t\t\t\t\tcontinue 2;\n\t\t\t\t\t\t\t\tcase 19:\n\t\t\t\t\t\t\t\t\t$lnkey[7][] = $before_note_pos + $before_measure;\n\t\t\t\t\t\t\t\t\t$lnkey[7][] = (int)$now_measure + $note_pos;\n\t\t\t\t\t\t\t\t\tcontinue 2;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t}\n\n\n\t\t\t}\n\t\t\t// HEADER 処理\n\t\t\telse{\n\t\t\t\t$header = explode(\" \", $temp_str, 2);\n\t\t\t\t$header_map[$header[0]] = htmlspecialchars(substr($header[1], 0, -1), ENT_QUOTES, \"UTF-8\");\n\t\t\t}\n\t\t}\n\t}\n\n\tif($header_map[\"TITLE\"] == null){\n\t\techo '<div class=\"alert alert-danger\">';\n\t\techo \"このBMSファイルには#TITLEが存在しなかったため、アップロードは行われませんでした。 \".date(\"H:i:s\");\n\t\techo \"</div>\";\n\t\texit();\n\t}\n\tif($total_notes <= 0){\n\t\techo '<div class=\"alert alert-danger\">';\n\t\techo \"このBMSファイルには可視ノーツが1つも存在しなかったため、アップロードは行われませんでした。 \".date(\"H:i:s\");\n\t\techo \"</div>\";\n\t\texit();\n\t}\n\tif($header_map[\"RANDOM\"] != null){\n\t\techo '<div class=\"alert alert-danger\">';\n\t\techo \"このBMSファイルには#RANDOMが存在したため、アップロードは行われませんでした。 \".date(\"H:i:s\");\n\t\techo \"</div>\";\n\t\texit();\n\t}\n\t\n\tfor($key_num = 0; $key_num <= 7; $key_num++){\n\t\tsort($lnkey[$key_num]);\n\t\t\n\t\tfor($i = 0; $i < count($lnkey[$key_num]); $i += 2){\n\t\t\t$ln_start_measure = floor($lnkey[$key_num][$i]);\n\t\t\t$ln_end_measure = floor($lnkey[$key_num][$i + 1]);\n\t\t\t\n\t\t\tfor($now_measure = $ln_start_measure; $now_measure <= $ln_end_measure; $now_measure++){\n\t\t\t\tif($ln_start_measure != $now_measure && $ln_end_measure != $now_measure){\n\t\t\t\t\t$ln_pos[$key_num][$now_measure][\"start\"][] = 0.0;\n\t\t\t\t\t$ln_pos[$key_num][$now_measure][\"end\"][] = 1.0;\n\t\t\t\t}\n\t\t\t\telse if($ln_start_measure == $now_measure && $ln_end_measure != $now_measure){\n\t\t\t\t\t(double)$ln_pos[$key_num][$now_measure][\"start\"][] = (double)($lnkey[$key_num][$i] - floor($lnkey[$key_num][$i]));\n\t\t\t\t\t(double)$ln_pos[$key_num][$now_measure][\"end\"][] = 1.0;\n\t\t\t\t}\n\t\t\t\telse if($ln_start_measure != $now_measure && $ln_end_measure == $now_measure){\n\t\t\t\t\t(double)$ln_pos[$key_num][$now_measure][\"start\"][] = 0.0;\n\t\t\t\t\t(double)$ln_pos[$key_num][$now_measure][\"end\"][] = (double)($lnkey[$key_num][$i + 1] - (double)floor($lnkey[$key_num][$i + 1]));\n\t\t\t\t}\n\t\t\t\telse if($ln_start_measure == $now_measure && $ln_end_measure == $now_measure){\n\t\t\t\t\t(double)$ln_pos[$key_num][$now_measure][\"start\"][] = (double)($lnkey[$key_num][$i] - (double)floor($lnkey[$key_num][$i]));\n\t\t\t\t\t(double)$ln_pos[$key_num][$now_measure][\"end\"][] = (double)($lnkey[$key_num][$i + 1] - (double)floor($lnkey[$key_num][$i + 1]));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\t//out json\n\t$output_json = array(\n\t\t\"GENRE\" => $header_map[\"GENRE\"],\n\t\t\"TITLE\" => $header_map[\"TITLE\"],\n\t\t\"ARTIST\" => $header_map[\"ARTIST\"],\n\t\t\"BPM\" => $header_map[\"BPM\"],\n\t\t\"RANK\" => $header_map[\"RANK\"],\n\t\t\"TOTAL\" => $header_map[\"TOTAL\"],\n\n\t\t\"notes\" => $total_notes,\n\t\t\"measure\" => $max_measure,\n\t\t\"measure_length\" => $measure_length,\n\n\t\t\"lgkey\" => $key,\n\t\t\"lnkey\" => $lnkey,\n\t\t\"lnlength\" => $ln_pos,\n\t\t\n\t\t/*\n\t\t\"landmine\" => ,\n\t\t*/\n\n\t\t\"difficulty\" => $difficulty,\n\t);\n\t\n\t// db\n\t\n\t$dbtemp = file_get_contents(\"./db.json\");\n\t$out = json_decode($dbtemp, true);\n\t\n\t$table_json = array(\n\t\t\"TITLE\" => $header_map[\"TITLE\"],\n\t\t\"ARTIST\" => $header_map[\"ARTIST\"],\n\t\t\"md5\" => $file_hash,\n\t);\n\t\n\t$table_cnt = 0;\n\t$table_flag = false;\n\twhile($out[$table_cnt][\"md5\"] != null){\n\t\tif($out[$table_cnt][\"md5\"] == $file_hash){\n\t\t\t$table_flag = true;\n\t\t\tbreak;\n\t\t}\n\t}\n\t\n\tif($table_flag)\n\t\t$out[$table_cnt] = $table_json;\n\telse\n\t\t$out[] = $table_json;\n\t\t\n\tfile_put_contents(\"./db.json\", json_encode($out));\n\t\n\t// end of db\n\n\t$file_upload_success = file_put_contents($file_name, json_encode($output_json));\n\tif(!($file_upload_success === FALSE)){\n\t\techo '<div class=\"alert alert-success\">';\n\t\techo \"アップロードに成功しました。 : \".$header_map[\"TITLE\"].\", \".date(\"H:i:s\").\"<br />\";\n\t\techo \"<a href=\\\"\".\"./score.php?md5=\".$file_hash.\"\\\">\".\"Score\".\"</a>\";\n\t\techo '</div>';\n\t}\n\telse{\n\t\techo '<div class=\"alert alert-danger\">';\n\t\techo \"譜面のアップロードに失敗しました。<br />しばらく時間をおいてからもう一度試してみてください。 \".date(\"H:i:s\");\n\t\techo '</div>';\n\t}\n}\n\nelse{\n\techo '<div class=\"alert alert-danger\">';\n\techo \"ファイルが選択されていません\";\n\techo \"</div>\";\n}\n\n?>\n","undoManager":{"mark":98,"position":100,"stack":[[{"start":{"row":265,"column":7},"end":{"row":265,"column":8},"action":"insert","lines":["k"],"id":535}],[{"start":{"row":265,"column":8},"end":{"row":265,"column":9},"action":"insert","lines":[";"],"id":536}],[{"start":{"row":266,"column":3},"end":{"row":267,"column":0},"action":"insert","lines":["",""],"id":537},{"start":{"row":267,"column":0},"end":{"row":267,"column":2},"action":"insert","lines":["\t\t"]}],[{"start":{"row":267,"column":2},"end":{"row":267,"column":3},"action":"insert","lines":["e"],"id":538}],[{"start":{"row":267,"column":3},"end":{"row":267,"column":4},"action":"insert","lines":["l"],"id":539}],[{"start":{"row":267,"column":4},"end":{"row":267,"column":5},"action":"insert","lines":["s"],"id":540}],[{"start":{"row":267,"column":5},"end":{"row":267,"column":6},"action":"insert","lines":["e"],"id":541}],[{"start":{"row":267,"column":6},"end":{"row":267,"column":7},"action":"insert","lines":["{"],"id":542}],[{"start":{"row":267,"column":7},"end":{"row":269,"column":3},"action":"insert","lines":["","\t\t\t","\t\t}"],"id":543}],[{"start":{"row":264,"column":3},"end":{"row":264,"column":4},"action":"insert","lines":["o"],"id":544}],[{"start":{"row":264,"column":4},"end":{"row":264,"column":5},"action":"insert","lines":["u"],"id":545}],[{"start":{"row":264,"column":5},"end":{"row":264,"column":6},"action":"insert","lines":["t"],"id":546}],[{"start":{"row":264,"column":5},"end":{"row":264,"column":6},"action":"remove","lines":["t"],"id":547}],[{"start":{"row":264,"column":4},"end":{"row":264,"column":5},"action":"remove","lines":["u"],"id":548}],[{"start":{"row":264,"column":3},"end":{"row":264,"column":4},"action":"remove","lines":["o"],"id":549}],[{"start":{"row":270,"column":2},"end":{"row":271,"column":22},"action":"remove","lines":["","\t$out[] = $table_json;"],"id":550}],[{"start":{"row":266,"column":3},"end":{"row":269,"column":3},"action":"remove","lines":["","\t\telse{","\t\t\t","\t\t}"],"id":551}],[{"start":{"row":264,"column":3},"end":{"row":265,"column":22},"action":"insert","lines":["","\t$out[] = $table_json;"],"id":552}],[{"start":{"row":265,"column":0},"end":{"row":265,"column":1},"action":"insert","lines":["\t"],"id":553}],[{"start":{"row":265,"column":1},"end":{"row":265,"column":2},"action":"insert","lines":["\t"],"id":554}],[{"start":{"row":265,"column":8},"end":{"row":265,"column":9},"action":"insert","lines":["$"],"id":555}],[{"start":{"row":265,"column":9},"end":{"row":265,"column":10},"action":"insert","lines":["t"],"id":556}],[{"start":{"row":265,"column":10},"end":{"row":265,"column":11},"action":"insert","lines":["a"],"id":557}],[{"start":{"row":265,"column":8},"end":{"row":265,"column":11},"action":"remove","lines":["$ta"],"id":558},{"start":{"row":265,"column":8},"end":{"row":265,"column":18},"action":"insert","lines":["$table_cnt"]}],[{"start":{"row":264,"column":2},"end":{"row":264,"column":3},"action":"remove","lines":["\t"],"id":559}],[{"start":{"row":264,"column":1},"end":{"row":264,"column":2},"action":"remove","lines":["\t"],"id":560}],[{"start":{"row":264,"column":0},"end":{"row":264,"column":1},"action":"remove","lines":["\t"],"id":561}],[{"start":{"row":263,"column":44},"end":{"row":264,"column":0},"action":"remove","lines":["",""],"id":562}],[{"start":{"row":263,"column":44},"end":{"row":264,"column":34},"action":"remove","lines":["","\t\t\t$out[$table_cnt] = $table_json;"],"id":563}],[{"start":{"row":263,"column":44},"end":{"row":264,"column":0},"action":"insert","lines":["",""],"id":564},{"start":{"row":264,"column":0},"end":{"row":264,"column":3},"action":"insert","lines":["\t\t\t"]}],[{"start":{"row":264,"column":3},"end":{"row":264,"column":4},"action":"insert","lines":["$"],"id":565}],[{"start":{"row":264,"column":4},"end":{"row":264,"column":5},"action":"insert","lines":["t"],"id":566}],[{"start":{"row":264,"column":5},"end":{"row":264,"column":6},"action":"insert","lines":["a"],"id":567}],[{"start":{"row":264,"column":6},"end":{"row":264,"column":7},"action":"insert","lines":["b"],"id":568}],[{"start":{"row":264,"column":7},"end":{"row":264,"column":8},"action":"insert","lines":["l"],"id":569}],[{"start":{"row":264,"column":8},"end":{"row":264,"column":9},"action":"insert","lines":["e"],"id":570}],[{"start":{"row":264,"column":9},"end":{"row":264,"column":10},"action":"insert","lines":["_"],"id":571}],[{"start":{"row":264,"column":10},"end":{"row":264,"column":11},"action":"insert","lines":["f"],"id":572}],[{"start":{"row":264,"column":11},"end":{"row":264,"column":12},"action":"insert","lines":["l"],"id":573}],[{"start":{"row":264,"column":12},"end":{"row":264,"column":13},"action":"insert","lines":["a"],"id":574}],[{"start":{"row":264,"column":13},"end":{"row":264,"column":14},"action":"insert","lines":["g"],"id":575}],[{"start":{"row":264,"column":14},"end":{"row":264,"column":15},"action":"insert","lines":[" "],"id":576}],[{"start":{"row":264,"column":15},"end":{"row":264,"column":16},"action":"insert","lines":["="],"id":577}],[{"start":{"row":264,"column":16},"end":{"row":264,"column":17},"action":"insert","lines":[" "],"id":578}],[{"start":{"row":264,"column":17},"end":{"row":264,"column":18},"action":"insert","lines":["t"],"id":579}],[{"start":{"row":264,"column":18},"end":{"row":264,"column":19},"action":"insert","lines":["r"],"id":580}],[{"start":{"row":264,"column":19},"end":{"row":264,"column":20},"action":"insert","lines":["u"],"id":581}],[{"start":{"row":264,"column":20},"end":{"row":264,"column":21},"action":"insert","lines":["e"],"id":582}],[{"start":{"row":264,"column":21},"end":{"row":264,"column":22},"action":"insert","lines":["m"],"id":583}],[{"start":{"row":264,"column":21},"end":{"row":264,"column":22},"action":"remove","lines":["m"],"id":584}],[{"start":{"row":264,"column":21},"end":{"row":264,"column":22},"action":"insert","lines":[";"],"id":585}],[{"start":{"row":261,"column":16},"end":{"row":262,"column":0},"action":"insert","lines":["",""],"id":586},{"start":{"row":262,"column":0},"end":{"row":262,"column":1},"action":"insert","lines":["\t"]}],[{"start":{"row":262,"column":1},"end":{"row":262,"column":2},"action":"insert","lines":["$"],"id":587}],[{"start":{"row":262,"column":2},"end":{"row":262,"column":3},"action":"insert","lines":["t"],"id":588}],[{"start":{"row":262,"column":3},"end":{"row":262,"column":4},"action":"insert","lines":["a"],"id":589}],[{"start":{"row":262,"column":4},"end":{"row":262,"column":5},"action":"insert","lines":["b"],"id":590}],[{"start":{"row":262,"column":1},"end":{"row":262,"column":5},"action":"remove","lines":["$tab"],"id":591},{"start":{"row":262,"column":1},"end":{"row":262,"column":12},"action":"insert","lines":["$table_flag"]}],[{"start":{"row":262,"column":12},"end":{"row":262,"column":13},"action":"insert","lines":[" "],"id":592}],[{"start":{"row":262,"column":13},"end":{"row":262,"column":14},"action":"insert","lines":["="],"id":593}],[{"start":{"row":262,"column":14},"end":{"row":262,"column":15},"action":"insert","lines":[" "],"id":594}],[{"start":{"row":262,"column":15},"end":{"row":262,"column":16},"action":"insert","lines":["f"],"id":595}],[{"start":{"row":262,"column":16},"end":{"row":262,"column":17},"action":"insert","lines":["a"],"id":596}],[{"start":{"row":262,"column":17},"end":{"row":262,"column":18},"action":"insert","lines":["l"],"id":597}],[{"start":{"row":262,"column":18},"end":{"row":262,"column":19},"action":"insert","lines":["s"],"id":598}],[{"start":{"row":262,"column":19},"end":{"row":262,"column":20},"action":"insert","lines":["e"],"id":599}],[{"start":{"row":262,"column":20},"end":{"row":262,"column":21},"action":"insert","lines":[";"],"id":600}],[{"start":{"row":268,"column":2},"end":{"row":269,"column":0},"action":"insert","lines":["",""],"id":601},{"start":{"row":269,"column":0},"end":{"row":269,"column":1},"action":"insert","lines":["\t"]}],[{"start":{"row":269,"column":1},"end":{"row":269,"column":2},"action":"insert","lines":["i"],"id":602}],[{"start":{"row":269,"column":2},"end":{"row":269,"column":3},"action":"insert","lines":["f"],"id":603}],[{"start":{"row":269,"column":3},"end":{"row":269,"column":5},"action":"insert","lines":["()"],"id":604}],[{"start":{"row":269,"column":4},"end":{"row":269,"column":5},"action":"insert","lines":["T"],"id":605}],[{"start":{"row":269,"column":4},"end":{"row":269,"column":5},"action":"remove","lines":["T"],"id":606}],[{"start":{"row":269,"column":4},"end":{"row":269,"column":5},"action":"insert","lines":["$"],"id":607}],[{"start":{"row":269,"column":5},"end":{"row":269,"column":6},"action":"insert","lines":["t"],"id":608}],[{"start":{"row":269,"column":6},"end":{"row":269,"column":7},"action":"insert","lines":["a"],"id":609}],[{"start":{"row":269,"column":4},"end":{"row":269,"column":7},"action":"remove","lines":["$ta"],"id":610},{"start":{"row":269,"column":4},"end":{"row":269,"column":15},"action":"insert","lines":["$table_flag"]}],[{"start":{"row":269,"column":16},"end":{"row":269,"column":17},"action":"insert","lines":["{"],"id":611}],[{"start":{"row":269,"column":17},"end":{"row":271,"column":2},"action":"insert","lines":["","\t\t","\t}"],"id":612}],[{"start":{"row":270,"column":2},"end":{"row":271,"column":22},"action":"insert","lines":["","\t$out[] = $table_json;"],"id":613}],[{"start":{"row":271,"column":0},"end":{"row":271,"column":1},"action":"insert","lines":["\t"],"id":614}],[{"start":{"row":270,"column":0},"end":{"row":270,"column":1},"action":"remove","lines":["\t"],"id":615}],[{"start":{"row":269,"column":17},"end":{"row":270,"column":1},"action":"remove","lines":["","\t"],"id":616}],[{"start":{"row":270,"column":7},"end":{"row":270,"column":8},"action":"insert","lines":["$"],"id":617}],[{"start":{"row":270,"column":8},"end":{"row":270,"column":9},"action":"insert","lines":["t"],"id":618}],[{"start":{"row":270,"column":9},"end":{"row":270,"column":10},"action":"insert","lines":["a"],"id":619}],[{"start":{"row":270,"column":7},"end":{"row":270,"column":10},"action":"remove","lines":["$ta"],"id":620},{"start":{"row":270,"column":7},"end":{"row":270,"column":17},"action":"insert","lines":["$table_cnt"]}],[{"start":{"row":271,"column":2},"end":{"row":272,"column":0},"action":"insert","lines":["",""],"id":621},{"start":{"row":272,"column":0},"end":{"row":272,"column":1},"action":"insert","lines":["\t"]}],[{"start":{"row":272,"column":1},"end":{"row":272,"column":2},"action":"insert","lines":["e"],"id":622}],[{"start":{"row":272,"column":2},"end":{"row":272,"column":3},"action":"insert","lines":["l"],"id":623}],[{"start":{"row":272,"column":3},"end":{"row":272,"column":4},"action":"insert","lines":["s"],"id":624}],[{"start":{"row":272,"column":4},"end":{"row":272,"column":5},"action":"insert","lines":["e"],"id":625}],[{"start":{"row":269,"column":16},"end":{"row":269,"column":17},"action":"remove","lines":["{"],"id":626}],[{"start":{"row":268,"column":2},"end":{"row":269,"column":0},"action":"insert","lines":["",""],"id":627},{"start":{"row":269,"column":0},"end":{"row":269,"column":1},"action":"insert","lines":["\t"]}],[{"start":{"row":272,"column":1},"end":{"row":272,"column":2},"action":"remove","lines":["}"],"id":628}],[{"start":{"row":272,"column":1},"end":{"row":273,"column":0},"action":"remove","lines":["",""],"id":629}],[{"start":{"row":272,"column":1},"end":{"row":272,"column":2},"action":"remove","lines":["\t"],"id":630}],[{"start":{"row":272,"column":5},"end":{"row":273,"column":22},"action":"insert","lines":["","\t$out[] = $table_json;"],"id":631}],[{"start":{"row":273,"column":0},"end":{"row":273,"column":1},"action":"insert","lines":["\t"],"id":632}],[{"start":{"row":273,"column":23},"end":{"row":274,"column":0},"action":"insert","lines":["",""],"id":633},{"start":{"row":274,"column":0},"end":{"row":274,"column":2},"action":"insert","lines":["\t\t"]}],[{"start":{"row":283,"column":7},"end":{"row":283,"column":71},"action":"remove","lines":["\"<a href=\\\"\".\"./score.php?md5=\".$file_hash.\"\\\">\".\"Score\".\"</a>\";"],"id":634}],[{"start":{"row":283,"column":7},"end":{"row":283,"column":71},"action":"insert","lines":["\"<a href=\\\"\".\"./score.php?md5=\".$file_hash.\"\\\">\".\"Score\".\"</a>\";"],"id":635}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":7,"column":30},"end":{"row":7,"column":30},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":55,"state":"php-start","mode":"ace/mode/php"}},"timestamp":1433249381000}